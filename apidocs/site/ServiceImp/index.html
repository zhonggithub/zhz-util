<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../favicon.ico">
  
  <title>ServiceImp - seneca</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "ServiceImp";
    var mkdocs_page_input_path = "ServiceImp.md";
    var mkdocs_page_url = "/ServiceImp/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> seneca</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Overview</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../FCClient/">FCClient</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../FCService/">FCService</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ModelBase/">ModelBase</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ServiceBase/">ServiceBase</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">ServiceImp</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#serviceimp">ServiceImp</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#constructor">constructor</a></li>
        
            <li><a class="toctree-l3" href="#isvaliddatawhencreate">isValidDataWhenCreate</a></li>
        
            <li><a class="toctree-l3" href="#isvaliddatawhenupdate">isValidDataWhenUpdate</a></li>
        
            <li><a class="toctree-l3" href="#isvaliddatawhenretrieve">isValidDataWhenRetrieve</a></li>
        
            <li><a class="toctree-l3" href="#isvaliddatawhenupdatestatus">isValidDataWhenUpdateStatus</a></li>
        
            <li><a class="toctree-l3" href="#isexistwhencreate">isExistWhenCreate</a></li>
        
            <li><a class="toctree-l3" href="#isexistwhencreateimp">isExistWhenCreateImp</a></li>
        
            <li><a class="toctree-l3" href="#isvalidquerycondition">isValidQueryCondition</a></li>
        
            <li><a class="toctree-l3" href="#convertquerycriteria">convertQueryCriteria</a></li>
        
            <li><a class="toctree-l3" href="#convertcountcriteria">convertCountCriteria</a></li>
        
            <li><a class="toctree-l3" href="#do2po">do2po</a></li>
        
            <li><a class="toctree-l3" href="#do2powhenupdate">do2poWhenUpdate</a></li>
        
            <li><a class="toctree-l3" href="#po2do">po2do</a></li>
        
            <li><a class="toctree-l3" href="#list2do">list2do</a></li>
        
            <li><a class="toctree-l3" href="#beforecreate">beforeCreate</a></li>
        
            <li><a class="toctree-l3" href="#aftercreate">afterCreate</a></li>
        
            <li><a class="toctree-l3" href="#beforeupdate">beforeUpdate</a></li>
        
            <li><a class="toctree-l3" href="#afterupdate">afterUpdate</a></li>
        
            <li><a class="toctree-l3" href="#beforeupdatestatus">beforeUpdateStatus</a></li>
        
            <li><a class="toctree-l3" href="#afterupdatestatus">afterUpdateStatus</a></li>
        
            <li><a class="toctree-l3" href="#beforedestroy">beforeDestroy</a></li>
        
            <li><a class="toctree-l3" href="#afterdestroydestroy">afterDestroyDestroy</a></li>
        
            <li><a class="toctree-l3" href="#handlecatcherr">handleCatchErr</a></li>
        
            <li><a class="toctree-l3" href="#getcachekey">getCacheKey</a></li>
        
            <li><a class="toctree-l3" href="#getcachettl">getCacheTTL</a></li>
        
            <li><a class="toctree-l3" href="#delcache">delCache</a></li>
        
            <li><a class="toctree-l3" href="#parsequery">parseQuery</a></li>
        
            <li><a class="toctree-l3" href="#parselistquery">parseListQuery</a></li>
        
            <li><a class="toctree-l3" href="#parseexpand2include">parseExpand2Include</a></li>
        
            <li><a class="toctree-l3" href="#appendinclude">appendInclude</a></li>
        
            <li><a class="toctree-l3" href="#create">create</a></li>
        
            <li><a class="toctree-l3" href="#retrieve">retrieve</a></li>
        
            <li><a class="toctree-l3" href="#update">update</a></li>
        
            <li><a class="toctree-l3" href="#updatestatus">updateStatus</a></li>
        
            <li><a class="toctree-l3" href="#destroy">destroy</a></li>
        
            <li><a class="toctree-l3" href="#list">list</a></li>
        
            <li><a class="toctree-l3" href="#count">count</a></li>
        
            <li><a class="toctree-l3" href="#listall">listAll</a></li>
        
            <li><a class="toctree-l3" href="#findone">findOne</a></li>
        
            <li><a class="toctree-l3" href="#findall">findAll</a></li>
        
            <li><a class="toctree-l3" href="#findbyids">findByIds</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../util/">util</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../XmlUtil/">XmlUtil</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">seneca</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>ServiceImp</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="serviceimp">ServiceImp</h1>
<p>继承ServiceBase。实现接口：create、retrieve、update、updateStatus、list、count、listAll、findOne、logicDel、desctroy、treeList、findAll、findByIds</p>
<h2 id="constructor">constructor</h2>
<p><code>constructor ({ seneca, model, role, cache, cacheTTL, listCacheOn, opt, logger })</code></p>
<p>构造函数</p>
<h3 id="_1">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>seneca</td>
<td>seneca</td>
<td>是</td>
<td>无</td>
<td>seneca 对象</td>
</tr>
<tr>
<td>model</td>
<td>ModelBase</td>
<td>是</td>
<td>无</td>
<td></td>
</tr>
<tr>
<td>role</td>
<td>String</td>
<td>是</td>
<td>无</td>
<td>角色名称</td>
</tr>
<tr>
<td>cache</td>
<td>RedisCache</td>
<td>否</td>
<td>无</td>
<td>缓存</td>
</tr>
<tr>
<td>cacheTTL</td>
<td>Number, CacheTTLEnum</td>
<td>否</td>
<td>无</td>
<td>缓存周期。Number: 表示xx秒。CacheTTLEnum: s(60秒内)，m(60分钟内)，h(24小时内)，d(30天内)，M(12个月内)，y(一年)</td>
</tr>
<tr>
<td>listCacheOn</td>
<td>Boolean</td>
<td>否</td>
<td>true</td>
<td>list api是否开启缓存。true表示将会把list, listAll, findAll, findByIds的每一个资源进行缓存</td>
</tr>
<tr>
<td>opt</td>
<td>Object</td>
<td>否</td>
<td>true</td>
<td>默认api开启配置。false：不加载任何默认api；true：加载所有默认api；json对象表示加载对应的操作</td>
</tr>
<tr>
<td>logger</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>日志实例</td>
</tr>
</tbody>
</table>
<h2 id="isvaliddatawhencreate">isValidDataWhenCreate</h2>
<p><code>isValidDataWhenCreate (data)</code></p>
<p>创建的时候判断数据合法性，验证不通过返回ZError对象，否则返回null</p>
<h3 id="_2">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>创建时传入的数据</td>
</tr>
</tbody>
</table>
<h3 id="_3">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ret</td>
<td>ZError, null</td>
<td>否</td>
<td>无</td>
<td>验证不通过返回ZError对象，否则返回null</td>
</tr>
</tbody>
</table>
<h2 id="isvaliddatawhenupdate">isValidDataWhenUpdate</h2>
<p><code>isValidDataWhenUpdate (data)</code></p>
<p>更新的时候判断数据合法性，验证不通过返回ZError对象，否则返回null</p>
<h3 id="_4">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>更新时传入的数据</td>
</tr>
</tbody>
</table>
<h3 id="_5">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ret</td>
<td>ZError, null</td>
<td>否</td>
<td>无</td>
<td>验证不通过返回ZError对象，否则返回null</td>
</tr>
</tbody>
</table>
<h2 id="isvaliddatawhenretrieve">isValidDataWhenRetrieve</h2>
<p><code>isValidDataWhenRetrieve (id, expand)</code></p>
<p>获取数据时候判断数据是否包含必填字段，默认校验id，但是不对id合法性校验。验证不通过返回ZEerror对象,否则返回null</p>
<h3 id="_6">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>资源id</td>
</tr>
<tr>
<td>expand</td>
<td>String, Object</td>
<td>否</td>
<td>无</td>
<td>获取指定的子资源。expand=a,b 或 { a: true, b: true }</td>
</tr>
</tbody>
</table>
<h3 id="_7">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ret</td>
<td>ZError, null</td>
<td>否</td>
<td>无</td>
<td>验证不通过返回ZError对象，否则返回null</td>
</tr>
</tbody>
</table>
<h2 id="isvaliddatawhenupdatestatus">isValidDataWhenUpdateStatus</h2>
<p><code>isValidDataWhenUpdateStatus (id, expand)</code></p>
<p>更新状态时判断id, status必填字段，不对id，status合法性校验.验证不通过返回ZError对象,否则返回null</p>
<h3 id="_8">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>资源id</td>
</tr>
<tr>
<td>expand</td>
<td>String, Object</td>
<td>否</td>
<td>无</td>
<td>获取指定的子资源。expand=a,b 或 { a: true, b: true }</td>
</tr>
</tbody>
</table>
<h3 id="_9">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ret</td>
<td>ZError, null</td>
<td>否</td>
<td>无</td>
<td>验证不通过返回ZError对象，否则返回null</td>
</tr>
</tbody>
</table>
<h2 id="isexistwhencreate">isExistWhenCreate</h2>
<p><code>async isExistWhenCreate (data)</code></p>
<p>创建的时候校验数据唯一性。已存在数据的时返回ZError对象，否则返回null</p>
<h3 id="_10">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>创建时传入的数据</td>
</tr>
</tbody>
</table>
<h3 id="_11">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ret</td>
<td>ZError, null</td>
<td>否</td>
<td>无</td>
<td>验证不通过返回ZError对象，否则返回null</td>
</tr>
</tbody>
</table>
<h2 id="isexistwhencreateimp">isExistWhenCreateImp</h2>
<p><code>async isExistWhenCreateImp (params)</code></p>
<p>创建的时候校验数据唯一性。如果已存在资源则返回409的ZError对象，否则返回null</p>
<h3 id="_12">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>params</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>框架Model findOne 能识别的查询条件</td>
</tr>
</tbody>
</table>
<h3 id="_13">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ret</td>
<td>ZError, null</td>
<td>否</td>
<td>无</td>
<td>验证不通过返回409的ZError对象，否则返回null</td>
</tr>
</tbody>
</table>
<h2 id="isvalidquerycondition">isValidQueryCondition</h2>
<p><code>isValidQueryCondition (criteria)</code></p>
<p>判断list条件合法性. 验证不通过返回ZEerror对象,否则返回null</p>
<h3 id="_14">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>criteria</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>list时传入的查询条件</td>
</tr>
</tbody>
</table>
<h3 id="_15">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ret</td>
<td>ZError, null</td>
<td>否</td>
<td>无</td>
<td>验证不通过返回ZError对象，否则返回null</td>
</tr>
</tbody>
</table>
<h2 id="convertquerycriteria">convertQueryCriteria</h2>
<p><code>convertQueryCriteria (criteria, handle)</code></p>
<p>list前转换传入的字段查询条件。逻辑表达查询条件转换成sql条件</p>
<h3 id="_16">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>criteria</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>list时传入的字段查询条件</td>
</tr>
<tr>
<td>handle</td>
<td>Function</td>
<td>否</td>
<td>无</td>
<td>自定义处理函数。接收参数：(key, value, distData)。处理成功时把数据填在distData并返回ture, 否则返回false</td>
</tr>
</tbody>
</table>
<h3 id="_17">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ret</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>转换后的查询条件</td>
</tr>
</tbody>
</table>
<h2 id="convertcountcriteria">convertCountCriteria</h2>
<p><code>convertCountCriteria (criteria)</code></p>
<p>count前转换传入的查询条件。逻辑表达查询条件转换成sql条件。</p>
<h3 id="_18">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>criteria</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>count时传入的查询条件</td>
</tr>
</tbody>
</table>
<h3 id="_19">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ret</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>转换后的查询条件</td>
</tr>
</tbody>
</table>
<h2 id="do2po">do2po</h2>
<p><code>async do2po (data)</code></p>
<p>逻辑层数据转成db层数据</p>
<h3 id="_20">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>传入的逻辑层的数据</td>
</tr>
</tbody>
</table>
<h3 id="_21">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>返回db层数据</td>
</tr>
</tbody>
</table>
<h2 id="do2powhenupdate">do2poWhenUpdate</h2>
<p><code>async do2poWhenUpdate (data)</code></p>
<p>逻辑层数据转db层数据</p>
<h3 id="_22">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>传入的逻辑表现层的数据</td>
</tr>
</tbody>
</table>
<h3 id="_23">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>返回db层数据</td>
</tr>
</tbody>
</table>
<h2 id="po2do">po2do</h2>
<p><code>async po2do (data, expand)</code></p>
<p>db层数据转逻辑层数据。DO：Data Object。微服务运行时的实体，是核心业务的载体；PO：Persistent Object。与数据库结构一一映射，是数据持久化过程的数据载体。</p>
<h3 id="_24">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>传入的db层的数据</td>
</tr>
<tr>
<td>expand</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>获取指定资源的数据。{a: true, b: true}。如果是同一个service的model可以在parseExpand2Include返回include；如果跨service的资源获取，在此处实现获取逻辑</td>
</tr>
</tbody>
</table>
<h3 id="_25">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>返回逻辑表现层数据</td>
</tr>
</tbody>
</table>
<h2 id="list2do">list2do</h2>
<p><code>async list2do (items, expand)</code></p>
<p>list获得数据转换层逻辑表现层数据。默认循环调用db2logic</p>
<h3 id="_26">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>items</td>
<td>Object</td>
<td>是</td>
<td>无</td>
<td>传入的db层的数据</td>
</tr>
<tr>
<td>expand</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>获取指定资源的数据。{a: true, b: true}</td>
</tr>
</tbody>
</table>
<h3 id="_27">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object[]</td>
<td>否</td>
<td>无</td>
<td>逻辑表现层的数据数组</td>
</tr>
</tbody>
</table>
<h2 id="beforecreate">beforeCreate</h2>
<p><code>async beforeCreate (data)</code></p>
<p>创建之前调用</p>
<h3 id="_28">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>创建时传入的数据</td>
</tr>
</tbody>
</table>
<h2 id="aftercreate">afterCreate</h2>
<p><code>async afterCreate (data)</code></p>
<p>创建之后调用</p>
<h3 id="_29">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>创建后的数据</td>
</tr>
</tbody>
</table>
<h2 id="beforeupdate">beforeUpdate</h2>
<p><code>async beforeUpdate (data)</code></p>
<p>更新之前调用</p>
<h3 id="_30">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>更新时传入的数据</td>
</tr>
</tbody>
</table>
<h2 id="afterupdate">afterUpdate</h2>
<p><code>async afterUpdate (data)</code></p>
<p>更新之后调用</p>
<h3 id="_31">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>更新后的数据</td>
</tr>
</tbody>
</table>
<h2 id="beforeupdatestatus">beforeUpdateStatus</h2>
<p><code>async beforeUpdateStatus (data)</code></p>
<p>更新状态之前调用</p>
<h3 id="_32">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>更新前的数据</td>
</tr>
</tbody>
</table>
<h2 id="afterupdatestatus">afterUpdateStatus</h2>
<p><code>async afterUpdateStatus (data)</code></p>
<p>更新状态之后调用</p>
<h3 id="_33">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>更新后的数据</td>
</tr>
</tbody>
</table>
<h2 id="beforedestroy">beforeDestroy</h2>
<p><code>async beforeDestroy (data)</code></p>
<p>删除之前调用</p>
<h3 id="_34">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>删除时传入的数据</td>
</tr>
</tbody>
</table>
<h2 id="afterdestroydestroy">afterDestroyDestroy</h2>
<p><code>async afterDestroyDestroy (data)</code></p>
<p>删除之后调用</p>
<h3 id="_35">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>删除后传入的数据</td>
</tr>
</tbody>
</table>
<h2 id="handlecatcherr">handleCatchErr</h2>
<p><code>handleCatchErr (err)</code></p>
<p>统一处理错误的函数</p>
<h3 id="_36">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>err</td>
<td>Error</td>
<td>否</td>
<td>无</td>
<td>错误对象</td>
</tr>
</tbody>
</table>
<h3 id="_37">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>String</td>
<td>否</td>
<td>ERR_DB</td>
<td></td>
</tr>
<tr>
<td>message</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>错误描述</td>
</tr>
<tr>
<td>data</td>
<td>Error</td>
<td>否</td>
<td>无</td>
<td>错误对象</td>
</tr>
<tr>
<td>status</td>
<td>Number</td>
<td>否</td>
<td>500</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="getcachekey">getCacheKey</h2>
<p><code>getCacheKey (id, expand, full)</code></p>
<p>根据id, expand生成缓存key</p>
<h3 id="_38">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>是</td>
<td>无</td>
<td>资源id</td>
</tr>
<tr>
<td>expand</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>指定的子资源</td>
</tr>
<tr>
<td>full</td>
<td>Boolean</td>
<td>否</td>
<td>无</td>
<td>true: 表示获取包括redis keyPrefix及框架生成的key组合的完整key。false: 表示获取框架生成的key</td>
</tr>
</tbody>
</table>
<h3 id="_39">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>缓存key</td>
</tr>
</tbody>
</table>
<h2 id="getcachettl">getCacheTTL</h2>
<p><code>getCacheTTL ()</code></p>
<p>获取缓存时间</p>
<h3 id="_40">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ttl</td>
<td>Number</td>
<td>否</td>
<td>无</td>
<td>缓存时间</td>
</tr>
</tbody>
</table>
<h2 id="delcache">delCache</h2>
<p><code>async delCache (id)</code></p>
<p>删除缓存</p>
<h3 id="_41">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>资源id</td>
</tr>
</tbody>
</table>
<h3 id="_42">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>Number, Array</td>
<td>否</td>
<td>无</td>
<td>删除结果。如果通过key查找多个通配符key。则返回数组。否则返回Number</td>
</tr>
</tbody>
</table>
<h2 id="parsequery">parseQuery</h2>
<p><code>parseQuery (query)</code></p>
<p>解析查询条件。把查询条件转成orm识别的查询条件。sequlize应该转换成：{ where: query }；mongoose应该转换成：{...query}</p>
<h3 id="_43">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="_44">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>sequlize orm应该返回{ where: query }。mongoose应该返回{ ...query }</td>
</tr>
</tbody>
</table>
<h2 id="parselistquery">parseListQuery</h2>
<p><code>parseListQuery (query, sort, offset, limit)</code></p>
<p>解析list api传进来的查询条件。该函数会先调用parseQuery</p>
<h3 id="_45">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>字段查询条件</td>
</tr>
<tr>
<td>sort</td>
<td>Object, Array</td>
<td>否</td>
<td>无</td>
<td>排序。如果是json对象，数据格式为：{ a: -1, b: 1, c: 'ASC'}，如果是数组，数据格式为：[{ field: a, order: 'ASC'}, { field: b, order: 'DESC'}] 或 [[a, 'ASC'],[b, 'DESC']]</td>
</tr>
<tr>
<td>offset</td>
<td>Number</td>
<td>否</td>
<td>无</td>
<td></td>
</tr>
<tr>
<td>limit</td>
<td>Number</td>
<td>否</td>
<td>无</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="parseexpand2include">parseExpand2Include</h2>
<p><code>parseExpand2Include (expand)</code></p>
<p>解析expand: { a: true, b: true ....}。返回orm（例如：sequelize）能解析的include对象。该函数会在读操作：retrieve，list，listAll，findOne，findAll，findByIds之前调用。</p>
<h3 id="_46">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>expand</td>
<td>Object</td>
<td>是</td>
<td>无</td>
<td>子资源扩展数据。格式为：{ a: true, b: true, ....}</td>
</tr>
</tbody>
</table>
<h3 id="_47">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ret</td>
<td>Object, Array</td>
<td>是</td>
<td>无</td>
<td>解析成功返回orm（例如：sequelize）能解析的include对象, 否则返回null</td>
</tr>
</tbody>
</table>
<h2 id="appendinclude">appendInclude</h2>
<p><code>appendInclude (query, expand)</code></p>
<p>调用parseExpand2Include, 并把include添加到query对象里</p>
<h3 id="_48">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Object</td>
<td>是</td>
<td>无</td>
<td>db查询条件</td>
</tr>
<tr>
<td>expand</td>
<td>Object</td>
<td>是</td>
<td>无</td>
<td>子资源扩展数据。格式为：{ a: true, b: true, ....}</td>
</tr>
</tbody>
</table>
<h3 id="_49">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Object</td>
<td>是</td>
<td>无</td>
<td>{ ...query, include }</td>
</tr>
</tbody>
</table>
<h2 id="create">create</h2>
<p><code>async create ({ ...params })</code></p>
<p>创建一个资源。create执行流程：</p>
<ul>
<li>
<p>1，isValidDataWhenCreate </p>
</li>
<li>
<p>2，isExistWhenCreate </p>
</li>
<li>
<p>3，logic2DB </p>
</li>
<li>
<p>4，beforeCreate </p>
</li>
<li>
<p>5，model.create </p>
</li>
<li>
<p>6，afterCreate </p>
</li>
<li>
<p>7，db2logic</p>
</li>
</ul>
<h3 id="_50">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>...params</td>
<td>Object</td>
<td>是</td>
<td>无</td>
<td>资源对象</td>
</tr>
</tbody>
</table>
<h3 id="_51">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>是</td>
<td>无</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="retrieve">retrieve</h2>
<p><code>async retrieve ({ id, expand })</code></p>
<p>根据id获取资源详情。retrieve执行流程：</p>
<ul>
<li>
<p>1，isValidDataWhenRetrieve </p>
</li>
<li>
<p>2，parseExpand2Include </p>
</li>
<li>
<p>3，appendInclude </p>
</li>
<li>
<p>4，model.findById </p>
</li>
<li>
<p>5，db2logic </p>
</li>
</ul>
<p>retrieve会根据expand的不同生成不同key对应的缓存： </p>
<ul>
<li>如果没有指定expand, 缓存只包含通过资源id获取的数据 </li>
<li>如果指定了expand, 缓存包含通过资源id获取的数据及指定子资源的数据 </li>
</ul>
<h3 id="_52">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>是</td>
<td>无</td>
<td>资源对象id</td>
</tr>
<tr>
<td>expand</td>
<td>String</td>
<td>是</td>
<td>无</td>
<td>指定获取的子资源</td>
</tr>
</tbody>
</table>
<h3 id="_53">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>是</td>
<td>无</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="update">update</h2>
<p><code>async update ({ id, fields })</code></p>
<p>根据id更新数据。update执行流程：</p>
<ul>
<li>
<p>1，isValidDataWhenUpdate </p>
</li>
<li>
<p>2，logic2DBWhenUpdate </p>
</li>
<li>
<p>3，beforeUpdate </p>
</li>
<li>
<p>4，model.findByIdAndUpdate </p>
</li>
<li>
<p>5，afterUpdate </p>
</li>
<li>
<p>6，delCache </p>
</li>
<li>
<p>7，db2logic</p>
</li>
</ul>
<h3 id="_54">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>是</td>
<td>无</td>
<td>资源对象id</td>
</tr>
<tr>
<td>fields</td>
<td>Any</td>
<td>是</td>
<td>无</td>
<td>待更新的字段</td>
</tr>
</tbody>
</table>
<h3 id="_55">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>是</td>
<td>无</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="updatestatus">updateStatus</h2>
<p><code>async updateStatus ({ id, status })</code></p>
<p>根据id更新状态。updateStatus执行流程：</p>
<ul>
<li>
<p>1，isValidDataWhenUpdateStatus </p>
</li>
<li>
<p>2，beforeUpdateStatus </p>
</li>
<li>
<p>3，beforeUpdateStatus </p>
</li>
<li>
<p>4，model.findByIdAndUpdate </p>
</li>
<li>
<p>5，afterUpdateStatus</p>
</li>
</ul>
<h3 id="_56">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>是</td>
<td>无</td>
<td>资源对象id</td>
</tr>
<tr>
<td>status</td>
<td>Number</td>
<td>是</td>
<td>无</td>
<td>状态值</td>
</tr>
</tbody>
</table>
<h3 id="_57">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>是</td>
<td>无</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="destroy">destroy</h2>
<p><code>async destroy ({ id })</code></p>
<p>根据id删除一条数据。destroy执行流程：</p>
<ul>
<li>
<p>1，isValidDataWhenRetrieve </p>
</li>
<li>
<p>2，beforeDestroy </p>
</li>
<li>
<p>3，model.findByIdAndDelete </p>
</li>
<li>
<p>4，afterDestroy </p>
</li>
<li>
<p>5，delCache</p>
</li>
</ul>
<h3 id="_58">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>资源id</td>
</tr>
</tbody>
</table>
<h2 id="list">list</h2>
<p><code>async list ({ page, pageSize, limit, offset, sort, search, expand })</code></p>
<p>列表及分页。list执行流程：</p>
<ul>
<li>
<p>1，isValidQueryCondition </p>
</li>
<li>
<p>2，convertQueryCriteria </p>
</li>
<li>
<p>3，parseListQuery </p>
</li>
<li>
<p>4，parseExpand2Include </p>
</li>
<li>
<p>5，appendInclude </p>
</li>
<li>
<p>6，model.list </p>
</li>
<li>
<p>7，list2logic</p>
</li>
</ul>
<h3 id="_59">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>page</td>
<td>Number</td>
<td>否</td>
<td>1</td>
<td>当前页数</td>
</tr>
<tr>
<td>pageSize</td>
<td>Number</td>
<td>否</td>
<td>10</td>
<td>每页条数</td>
</tr>
<tr>
<td>limit</td>
<td>Number</td>
<td>否</td>
<td>10</td>
<td>同pageSize</td>
</tr>
<tr>
<td>offset</td>
<td>Number</td>
<td>否</td>
<td>无</td>
<td>起始条数</td>
</tr>
<tr>
<td>sort</td>
<td>Array，Object, String</td>
<td>否</td>
<td>无</td>
<td>排序。支持四种格式：array of { field: "", order: "DESC" }；array of [[field, "DESC"]]；object of {a: -1("DESC"), b: 1("ASC")}；sort=-a,b</td>
</tr>
<tr>
<td>search</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>搜索关键字</td>
</tr>
<tr>
<td>expand</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>获取指定子资源数据，多个子资源使用逗号隔开。例如：expand=a,b</td>
</tr>
</tbody>
</table>
<h3 id="_60">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>pageSize</td>
<td>Number</td>
<td>是</td>
<td>无</td>
<td>每页条数</td>
</tr>
<tr>
<td>page</td>
<td>Number</td>
<td>是</td>
<td>无</td>
<td>当前页数</td>
</tr>
<tr>
<td>total</td>
<td>Number</td>
<td>是</td>
<td>无</td>
<td>符合条件的总数量</td>
</tr>
<tr>
<td>limit</td>
<td>Number</td>
<td>是</td>
<td>无</td>
<td>同pageSize</td>
</tr>
<tr>
<td>offset</td>
<td>Number</td>
<td>是</td>
<td>无</td>
<td>起始条数</td>
</tr>
<tr>
<td>items</td>
<td>Number</td>
<td>否</td>
<td>无</td>
<td>返回数据项</td>
</tr>
</tbody>
</table>
<h2 id="count">count</h2>
<p><code>async count (query)</code></p>
<p>根据条件统计数量。count执行流程：</p>
<ul>
<li>
<p>1，isValidQueryCondition </p>
</li>
<li>
<p>2，convertCountCriteria </p>
</li>
<li>
<p>3，model.count</p>
</li>
</ul>
<h3 id="_61">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td>条件</td>
</tr>
</tbody>
</table>
<h3 id="_62">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Number</td>
<td>是</td>
<td>无</td>
<td>数量</td>
</tr>
</tbody>
</table>
<h2 id="listall">listAll</h2>
<p><code>async listAll ({ ...query, expand })</code></p>
<p>根据条件返回所有数据。listAll执行流程：</p>
<ul>
<li>
<p>1，isValidQueryCondition </p>
</li>
<li>
<p>2，convertQueryCriteria </p>
</li>
<li>
<p>3，parseExpand2Include </p>
</li>
</ul>
<p>4，appendInclude </p>
<ul>
<li>
<p>5，model.find </p>
</li>
<li>
<p>6, list2logic</p>
</li>
</ul>
<h3 id="_63">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>...query</td>
<td>...Object</td>
<td>否</td>
<td>无</td>
<td>各种查询条件条件</td>
</tr>
<tr>
<td>expand</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>获取指定子资源数据，多个子资源使用逗号隔开。例如：expand=a,b</td>
</tr>
</tbody>
</table>
<h3 id="_64">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object[]</td>
<td>否</td>
<td>无</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="findone">findOne</h2>
<p><code>async findOne ({ ...query, expand })</code></p>
<p>根据条件返回一条数据。findOne执行流程：</p>
<ul>
<li>
<p>1，convertQueryCriteria </p>
</li>
<li>
<p>2，parseExpand2Include </p>
</li>
<li>
<p>3，appendInclude </p>
</li>
<li>
<p>4，model.findOne </p>
</li>
<li>
<p>5，db2logic</p>
</li>
</ul>
<h3 id="_65">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>...query</td>
<td>...Object</td>
<td>否</td>
<td>无</td>
<td>各种查询条件条件</td>
</tr>
<tr>
<td>expand</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>获取指定子资源数据，多个子资源使用逗号隔开。例如：expand=a,b</td>
</tr>
</tbody>
</table>
<h3 id="_66">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object</td>
<td>否</td>
<td>无</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="findall">findAll</h2>
<p><code>async findAll ({ ...query, expand })</code></p>
<p>根据条件返回所有数据。findAll执行流程：</p>
<ul>
<li>
<p>1，convertQueryCriteria </p>
</li>
<li>
<p>2，parseExpand2Include </p>
</li>
<li>
<p>3，appendInclude </p>
</li>
<li>
<p>4，model.find </p>
</li>
<li>
<p>5，list2logic</p>
</li>
</ul>
<h3 id="_67">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>...query</td>
<td>...Object</td>
<td>否</td>
<td>无</td>
<td>各种查询条件条件</td>
</tr>
<tr>
<td>expand</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>获取指定子资源数据，多个子资源使用逗号隔开。例如：expand=a,b</td>
</tr>
</tbody>
</table>
<h3 id="_68">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object[]</td>
<td>否</td>
<td>无</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="findbyids">findByIds</h2>
<p><code>async findByIds ({ ids, expand })</code></p>
<p>根据id返回所有数据。findByIds执行流程：</p>
<ul>
<li>
<p>1，parseExpand2Include </p>
</li>
<li>
<p>2，appendInclude </p>
</li>
<li>
<p>3，model.find </p>
</li>
<li>
<p>4，list2logic</p>
</li>
</ul>
<h3 id="_69">参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ids</td>
<td>String[]</td>
<td>是</td>
<td>无</td>
<td>id数组</td>
</tr>
<tr>
<td>expand</td>
<td>String</td>
<td>否</td>
<td>无</td>
<td>获取指定子资源数据，多个子资源使用逗号隔开。例如：expand=a,b</td>
</tr>
</tbody>
</table>
<h3 id="_70">返回值</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Object[]</td>
<td>否</td>
<td>无</td>
<td></td>
</tr>
</tbody>
</table>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../util/" class="btn btn-neutral float-right" title="util">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../ServiceBase/" class="btn btn-neutral" title="ServiceBase"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>© Zz</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../ServiceBase/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../util/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
